SHELL = @SHELL@
srcdir = @srcdir@
PLATFORM_DIR = @bindir@
.SUFFIXES:
.SUFFIXES: .c .o

CC = @CC@
CFLAGS = @CFLAGS@ `gtk-config --cflags` -I.
LDFLAGS = @LDFLAGS@ `gtk-config --libs` -lSM -lICE
EXEC = ${PLATFORM_DIR}/${PROG}

############ Things to change for different programs

PROG = ROX-Session

SRCS = main.c gui_support.c choices.c gnome-ice.c ice.c \
       log.c session.c wm.c

OBJECTS = main.o gui_support.o choices.o gnome-ice.o ice.o \
	  log.o session.o wm.o

############ Things to keep the same

${EXEC}: ${PLATFORM_DIR} ${OBJECTS}
	${CC} -o ${EXEC} ${OBJECTS} ${LDFLAGS}

${PLATFORM_DIR}:
	mkdir ${PLATFORM_DIR}

clean:
	rm -f *.o Makefile.bak

depend:
	makedepend -- $(CFLAGS) -- $(SRCS)

Makefile: Makefile.in config.status
	./config.status

config.h: config.h.in
	./config.status

config.status: configure
	./configure --bindir=${PLATFORM_DIR}

configure: configure.in
	autoconf
